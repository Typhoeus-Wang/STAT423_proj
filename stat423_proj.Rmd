---
title: "stat423_proj_test"
author: "Yujia Dai"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup}
# setwd("/Users/typhoeus/Documents/Courses/STAT 423/Project/")
library(corrplot)
library(car)  
```


```{r data cleaning}
data <- read.csv("dataset_phishing.csv")
data <- data[, -1]
data <- data[, c(1:56, 81:ncol(data))] # remove content based features
data$status <- as.numeric(data$status == "phishing") #phishing -> 1, legitimate -> 0

which(is.na(data)) # check missing value

# check whether all value in the column has different value
all_zeros <- apply(data, 2, function(x) all(x == 0))
cat("Column names with all 0s:", colnames(data)[which(all_zeros)], "\n")
cat("Columns with all 0s:", which(all_zeros), "\n")
data <- data[, !all_zeros]

#corrplot(cor(data), type = "upper", tl.col = "black", tl.srt = 45, method = "circle")

# let categorical date become factor
columns_to_factor <- c("ip", "https_token", "punycode", "port", "tld_in_path", "tld_in_subdomain", "abnormal_subdomain", "prefix_suffix", "random_domain", "shortening_service", "path_extension", "domain_in_brand", "brand_in_subdomain", "brand_in_path", "suspecious_tld", "statistical_report", "whois_registered_domain", "dns_record", "google_index")
data[, columns_to_factor] <- lapply(data[, columns_to_factor], factor)
```

```{r multicollinearity}
fit1 <- glm(status ~., data = data, family = binomial)

# check multicollinearity
vif_values <- vif(fit1)[, 1]
columns_to_remove <- names(vif_values)[vif_values > 5]
datac <- data[, !names(data) %in% columns_to_remove]
#vif_values[vif_values < 5]

# combine all special character
special_char = rowSums(datac[, c(3:12)])
colnames(datac)[3] = "special_char"
datac[,3] = special_char
datac <- datac[,-c(4:12)]
```

```{r splitdata}
set.seed(123)
train <- sample(c(TRUE,FALSE), nrow(datac), rep = TRUE, prob = c(0.9,0.1))
test <- (!train)

train.data <- datac[train, ]
test.data <- datac[test,]
```


TODO: histogram, boxplot




```{r, check_model}

```


```{r}

```

