---
title: "stat423_proj_test"
author: "Yujia Dai"
date: "`r Sys.Date()`"
output: html_document
---


```{r data cleaning}
data <- read.csv("dataset_phishing.csv")
data <- data[, -1]
data <- data[, c(1:56, 81:ncol(data))] # remove content based features
data$status <- as.numeric(data$status == "phishing")
```

phishing -> 1
legitimate -> 0
```{r library}
library(corrplot)
library(car)  
```


```{r data checking}
#which(is.na(data)) # check missing value

all_zeros <- apply(data, 2, function(x) all(x == 0))
cat("Column names with all 0s:", colnames(data)[which(all_zeros)], "\n")
cat("Columns with all 0s:", which(all_zeros), "\n")
datac <- data[, !all_zeros]
#corrplot(cor(data), type = "upper", tl.col = "black", tl.srt = 45, method = "circle")

```
```{r}
columns_to_factor <- c("ip", "https_token", "punycode", "port", "tld_in_path", "tld_in_subdomain", "abnormal_subdomain", "prefix_suffix", "random_domain", "shortening_service", "path_extension", "domain_in_brand", "brand_in_subdomain", "brand_in_path", "suspecious_tld", "statistical_report", "whois_registered_domain", "dns_record", "google_index")
datac[, columns_to_factor] <- lapply(datac[, columns_to_factor], factor)
str(datac)
```



```{r model_fit}
fit1 <- glm(status ~., data = datac, family = binomial)
summary(fit1)
```
```{r, check_model}
vif_values <- vif(fit1)
columns_to_remove <- names(vif_values)[vif_values > 10]
data_cleaned <- data[, !names(data) %in% columns_to_remove]
```

